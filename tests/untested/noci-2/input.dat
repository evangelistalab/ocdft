#! Tests NOCI using DF integrals and the libfock class
import ocdft 

refnoci = [-91.899683696186, -91.836522371331, -91.785319104579,
           -91.743627763050, -91.719255665707, -91.709095535452,
           -91.680982627881, -91.655480299562, -91.235864422723]

molecule {
1 1
C          2.37059       -1.21851        0.91624
N          1.25941       -1.84561        0.86389
H          2.70138       -0.59950       -0.05828
H          0.17401       -2.15371        1.00621
}

set {
  basis sto-3g
  scf_type df
  df_basis_scf aug-cc-pV5Z-JKFIT
  reference uhf
  e_convergence 9
  d_convergence 1
  maxiter 100
}

set cdft {
  OCC_FROZEN [2]
  VIR_FROZEN [2]
}

energy('fasnocis')

for n in xrange(9):
    compare_values(refnoci[n], get_variable("NOCI ENERGY STATE %d" % n),8, "NOCI Energy State %d" % n) #TEST
