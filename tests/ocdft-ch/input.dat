#! OCDFT CPH algorithm test, B3LYP computation on ethene

import ocdft
refdft                = -78.531369464 #TEST
refocdft_singlet_spin = -78.261631126 #TEST
refocdft_triplet_spin = -78.363363976 #TEST

molecule {
0 1
H   0.000000   0.923274   1.238289
H   0.000000  -0.923274   1.238289
H   0.000000   0.923274  -1.238289
H   0.000000  -0.923274  -1.238289
C   0.000000   0.000000   0.668188
C   0.000000   0.000000  -0.668188
}

set {
  basis def2-svp
  df_basis_scf def2-svp-jkfit
  scf_type df
  reference uks
  maxiter 100
  e_convergence 11 
  d_convergence 6
}

set cdft {
  roots_per_irrep [0,0,0,0,0,1,0,0]
  cdft_exc_method ch
}

energy('ocdft', dft_functional='b3lyp')

compare_values(refdft, get_variable("DFT ENERGY"),8, "DFT energy") #TEST
compare_values(refocdft_singlet_spin, get_variable("OCDFT SINGLET ENERGY"),8, "OCDFT singlet energy") #TEST
compare_values(refocdft_triplet_spin, get_variable("OCDFT TRIPLET ENERGY"),8, "OCDFT triplet energy") #TEST
